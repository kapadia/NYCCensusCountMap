(this.webpackJsonpmap=this.webpackJsonpmap||[]).push([[0],{52:function(e,t,a){e.exports=a(85)},57:function(e,t,a){},81:function(e,t,a){},85:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),l=a(30),c=a.n(l),i=(a(57),a(47)),o=a(10),s=a(9),u=a(3),m=a(31),d=a.n(m);a(58);var p=a(16),f=a(17);function y(){return r.a.createElement("section",{className:"contact-type"},r.a.createElement("ul",null,r.a.createElement("li",{className:"category-entry"},r.a.createElement(p.a,{icon:f.a,style:{color:"#C2A5CF"}})," ","Internet First, English"),r.a.createElement("li",{className:"category-entry"},r.a.createElement(p.a,{icon:f.a,style:{color:"#9970AB"}})," ","Internet First, Bilingual"),r.a.createElement("li",{className:"category-entry"},r.a.createElement(p.a,{icon:f.a,style:{color:"#A6DBA0"}})," ","Internet Choice, English"),r.a.createElement("li",{className:"category-entry"},r.a.createElement(p.a,{icon:f.a,style:{color:"#5AAE61"}})," ","Internet Choice, Bilingual")))}function b(e){e.name;var t=e.min,a=e.max,n=e.colStart,l=e.colEnd,c="linear-gradient(90deg, ".concat(n," 0%, ").concat(l," 100%)");return console.log("gradient is ",c),r.a.createElement("div",{className:"range-legend"},r.a.createElement("div",{className:"range-legend-bar",style:{background:c}}),r.a.createElement("div",{className:"range-legend-labels"},r.a.createElement("p",null,t)," ",r.a.createElement("p",null,a)))}var h=a(21),E=a.n(h);a(38);function g(e){var t=e.boundaries,a=e.selectedBoundary,n=e.onSelect;return r.a.createElement("section",{className:"boundary-selector"},r.a.createElement("h3",null,"Boundaries"),t&&r.a.createElement(E.a,{options:Object.entries(t).map((function(e){var t=Object(u.a)(e,2);return{value:t[0],label:t[1].datasetName}})),onChange:function(e){return n(e.value)},value:a,placeholder:"Select a boundary"}))}function v(e){var t=e.selectedBoundary,a=e.boundaries,n=e.onSelectBoundary,l=e.showFacilities,c=e.onShowFacilitiesChange,i=e.onSelectMetric,o=e.metric;return r.a.createElement("div",{className:"Legend"},r.a.createElement("section",{className:"thematic-layer"},r.a.createElement("h3",null,"Metric"),r.a.createElement(E.a,{options:[{value:"strategy",label:"Mail Strategy"},{value:"returnCount",label:"2020 Mail Return Rate"}],onChange:function(e){return i(e.value)},value:o,placeholder:"Select a metric"}),"strategy"==o?r.a.createElement(y,null):r.a.createElement(b,{name:"2020 Mail Return %",min:0,max:100,colStart:"#309dae",colEnd:"#ebf7f9"}),r.a.createElement(g,{selectedBoundary:t,onSelect:n,boundaries:a}),r.a.createElement("div",{className:"facilitesToggle"},r.a.createElement("p",null,"Show Facilities"," ",r.a.createElement("input",{type:"checkbox",checked:l,onChange:function(e){return c(e.target.checked)}})))))}a(84);function C(e){var t=e.facility;return console.log("facilty",t),r.a.createElement("div",{className:"card facility"},r.a.createElement("h3",null,t.facname),r.a.createElement("p",null,t.address," ",r.a.createElement("br",null)," ",t.boro," ",r.a.createElement("br",null)," ",t.city," ",r.a.createElement("br",null)," ",t.zipcode),r.a.createElement("p",null,t.factype," "),r.a.createElement("p",null,"Capacity: ",t.capacity?t.capacity:"Unknown"))}var O=a(35);function j(e){var t=e.data,a=e.title,n=e.norm,l=e.style,c=t.sort((function(e,t){return e.value<t.value?1:-1}));if(n){var i=t.reduce((function(e,t){return e+t.value}),0);c=c.map((function(e){return Object(s.a)({},e,{value:e.value/i})}))}var o=Math.max.apply(Math,Object(O.a)(c.map((function(e){return e.value})))),u=Math.min.apply(Math,Object(O.a)(c.map((function(e){return e.value}))));return r.a.createElement("div",{style:l,className:"simple-bar-chart"},r.a.createElement("h3",null,a),r.a.createElement("div",{className:"bar-chart"},c.map((function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,e.label," "),r.a.createElement("span",{className:"bar",style:{backgroundColor:"blue",width:"".concat(100*(e.value-u)/(o-u),"%")}}),r.a.createElement("span",{className:"label"},e.value.toPrecision(2)))}))))}function S(e){var t=e.feature,a=e.facilities;e.onSelectFacility;console.log(t);var l=Object(n.useState)(!1),c=Object(u.a)(l,2),i=c[0],o=c[1];return r.a.createElement("div",{className:"feature"},t?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"details-header"},r.a.createElement("h2",null,"Census Tract: ",t.properties.GEOID),r.a.createElement("p",null,r.a.createElement("span",{onClick:function(){return o(!1)},className:i?"":"selected"},"Stats")," ","/"," ",r.a.createElement("span",{onClick:function(){return o(!0)},className:i?"selected":""},"Facilities"))),r.a.createElement("div",{className:"cards"},i?a.map((function(e){return r.a.createElement(C,{facility:e})})):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"card basic"},r.a.createElement("h3",null,"Basic Info"),r.a.createElement("p",null,"Population: ",r.a.createElement("span",null,t.properties.TotPopACS17)),r.a.createElement("p",null,"Mail return rate 2010:"," ",r.a.createElement("span",null,t.properties.MRR2010,"%")),r.a.createElement("p",null,"Inital Contact Strategy:",r.a.createElement("span",null,function(e){switch(e.strategy_code){case 0:return"Internet First, English";case 1:return"Internet First, Bilingual";case 2:return"Internet Choice, English";case 3:return"Internet Choice, Bilingual"}}(t.properties)))),r.a.createElement("div",{className:"card demographics"},r.a.createElement(j,{title:"Demographics",data:[{label:"white",value:t.properties.WhiteAloneOrCombo/t.properties.TotPopACS17},{label:"black",value:t.properties.BlackAloneOrCombo/t.properties.TotPopACS17},{label:"asian",value:t.properties.AsianAloneOrCombo/t.properties.TotPopACS17},{label:"hispanic",value:t.properties.Hispanic/t.properties.TotPopACS17}]})),r.a.createElement("div",{className:"card english_proficency"},r.a.createElement(j,{title:"English Proficency",data:function(e){return["LEPHHs","LEPspanHHs","LEPindoeurHHs","LEPapacHHs","LEPotherHHs"].map((function(t){return{value:e.properties[t],label:t}}))}(t),norm:!0})),r.a.createElement("div",{className:"card internet"},r.a.createElement(j,{title:"Internet Access",data:function(e){return["NoInternet","Internet_NoSub","Internet","DialUpOnly","Broadband_Any","Cellular","CellularOnly","Broadband_CableFiberOpticDSL","Broadband_CableFiberOpticDSLOnly","Satellite","SatelliteOnly","OtherOnly"].map((function(t){return{value:e.properties[t],label:t}}))}(t),norm:!0,style:{width:"500px"}}))))):r.a.createElement("div",{className:"placeholder"},r.a.createElement("h2",null,"Click tract for details")))}var N=a(46),w=a.n(N);var k={strategy:["match",["get","strategy_code"],0,"#C2A5CF",1,"#9970AB",2,"#A6DBA0",3,"#5AAE61","grey"],returnCount:["interpolate",["linear"],["get","MRR2010"],0,"#309dae",100,"#ebf7f9"]},A={HTCLayer:{url:"".concat("/NYCCensusCountMap","/CensusTractsAllVariables.geojson"),paintFill:{"fill-color":"grey","fill-opacity":.7},paintLine:{"line-color":["case",["boolean",["coalesce",["feature-state","selected"],!1],!0],"red","white"],"line-width":["case",["boolean",["coalesce",["feature-state","selected"],!1],!0],3,1]}}};function F(e,t){var a=Object(n.useState)({}),r=Object(u.a)(a,2),l=r[0],c=r[1];return Object(n.useEffect)((function(){if(e.current){var a={};e.current.on("load",(function(){console.log("adding boundary layers"),[{id:"cd",datasetName:"Community Districts",url:"http://data.cityofnewyork.us/api/geospatial/yfnk-k7r4?method=export&format=Shapefile",nameCol:"boro_cd",nameAlt:null},{id:"pp",datasetName:"Police Precincts",url:"http://data.cityofnewyork.us/api/geospatial/78dh-3ptz?method=export&format=Shapefile",nameCol:"precinct",nameAlt:null},{id:"sd",datasetName:"School Districts",url:"http://data.cityofnewyork.us/api/geospatial/r8nu-ymqj?method=export&format=Shapefile",nameCol:"district",nameAlt:"districtco"},{id:"hc",datasetName:"Health Center Districts",url:"http://data.cityofnewyork.us/api/geospatial/b55q-34ps?method=export&format=Shapefile",nameCol:"hcent_dist",nameAlt:null},{id:"cc",datasetName:"City Council Districts",url:"http://data.cityofnewyork.us/api/geospatial/yusd-j4xi?method=export&format=Shapefile",nameCol:"coun_dist",nameAlt:null},{id:"nycongress",datasetName:"Congressional Districts",url:"http://data.cityofnewyork.us/api/geospatial/qd3c-zuu7?method=export&format=Shapefile",nameCol:"cong_dist",nameAlt:null},{id:"sa",datasetName:"State Assembly Districts",url:"http://data.cityofnewyork.us/api/geospatial/pf5b-73bw?method=export&format=Shapefile",nameCol:"assem_dist",nameAlt:null},{id:"ss",datasetName:"State Senate Districts",url:"http://data.cityofnewyork.us/api/geospatial/h4i2-acfi?method=export&format=Shapefile",nameCol:"st_sen_dis",nameAlt:null},{id:"nta",datasetName:"Neighborhood Tabulation Area",url:"http://data.cityofnewyork.us/api/geospatial/cpf4-rkhq?method=export&format=Shapefile",nameCol:"ntaname",nameAlt:"ntacode"},{id:"bid",datasetName:"Business Improvement District",url:"http://data.cityofnewyork.us/api/geospatial/ejxk-d93y?method=export&format=Shapefile",nameCol:"bid",nameAlt:null}].map((function(e){return Object(s.a)({},e,{paintLine:{"line-color":"black"}})})).forEach((function(n){var r="".concat(n.id,"_source"),l=Object(s.a)({},n);console.log("adding source ",r),l.source=e.current.addSource(r,{type:"geojson",data:"".concat("/NYCCensusCountMap","/boundaries/").concat(n.id,".geojson")}),n.paintFill&&(l.fillLayer=e.current.addLayer({id:"".concat(n.id,"-fill"),type:"fill",source:r,paint:n.paintFill},"waterway-label")),n.paintLine&&(l.lineLayer=e.current.addLayer({id:"".concat(n.id,"-line"),type:"line",source:r,paint:n.paintLine,layout:{visibility:t==n.id?"visible":"none"}},"waterway-label")),a[n.id]=l})),c(a)}))}}),[e]),Object(n.useEffect)((function(){e.current&&Object.entries(l).forEach((function(a){var n=Object(u.a)(a,2),r=n[0],l=n[1];e.current.setLayoutProperty("".concat(l.id,"-line"),"visibility",r==t?"visible":"none")}))}),[e,t]),l}function L(e,t){var a=function(){var e=Object(n.useState)(null),t=Object(u.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){fetch("".concat("/NYCCensusCountMap","/facilities.geojson")).then((function(e){return e.json()})).then((function(e){return r(e)}))}),[]),a}();return Object(n.useEffect)((function(){console.log("Map ",e," Facilities ",a),e.current&&a&&e.current.on("load",(function(){e.current.loadImage("".concat("/NYCCensusCountMap","/marker.png"),(function(n,r){if(n)throw n;e.current.addImage("marker",r),e.current.addLayer({id:"facilities",type:"symbol",source:{type:"geojson",data:a},layout:{"icon-image":"marker","icon-size":.4,"text-field":["get","facname"],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-offset":[0,.6],"text-size":10,"text-anchor":"top",visibility:t?"visible":"none"}})}))}))}),[e,a]),Object(n.useEffect)((function(){e.current&&e.current.loaded()&&e.current.setLayoutProperty("facilities","visibility",t?"visible":"none")}),[e,t]),a}function x(){var e=Object(n.useRef)(null),t=Object(n.useState)("cd"),a=Object(u.a)(t,2),l=a[0],c=a[1],i=Object(n.useState)(null),o=Object(u.a)(i,2),m=o[0],p=o[1],f=Object(n.useState)([]),y=Object(u.a)(f,2),b=(y[0],y[1]),h=Object(n.useState)(!0),E=Object(u.a)(h,2),g=E[0],C=E[1],O=Object(n.useState)("strategy"),j=Object(u.a)(O,2),N=j[0],x=j[1];Object(n.useEffect)((function(){w.a.parse("/hard_to_count_NY.csv",{download:!0,header:!0,complete:function(e){b(e)}})}),[]);var B=function(e,t){var a=t.lnglat,r=t.zoom,l=t.style,c=t.key;d.a.accessToken=c;var i=Object(n.useRef)(null);return Object(n.useEffect)((function(){i.current=new d.a.Map({container:e.current,style:l,center:a,zoom:r})}),[e]),i}(e,{lnglat:[-73.9920330193022,40.75078660435196],zoom:10,style:"mapbox://styles/mapbox/light-v10",key:"pk.eyJ1Ijoic3R1YXJ0LWx5bm4iLCJhIjoiM2Q4ODllNmRkZDQ4Yzc3NTBhN2UyNDE0MWY2OTRiZWIifQ.8OEKvgZBCCtDFUXkjt66Pw"}),I=Object(s.a)({},A.HTCLayer,{},{paintFill:{"fill-color":k[N]}}),M=(function(e,t,a){var r=a.url,l=a.paintFill,c=a.paintLine,i=(a.sourceLayer,a.onClick),o=a.selection,s=Object(n.useRef)(null),u=Object(n.useRef)(null),m=Object(n.useRef)(null),d="".concat(t,"_source"),p=Object(n.useRef)(null);Object(n.useEffect)((function(){e.current&&e.current.on("load",(function(){m.current=e.current.addSource(d,{type:"geojson",data:r}),l&&(s.current=e.current.addLayer({id:"".concat(t,"-fill"),type:"fill",source:d,paint:l},"waterway-label")),c&&(u.current=e.current.addLayer({id:"".concat(t,"-line"),type:"line",source:d,paint:c},"waterway-label")),e.current.on("click","".concat(t,"-fill"),(function(e){console.log(e.features[0]),i&&i(e.features[0])}))}))}),[e]),Object(n.useEffect)((function(){e.current&&o&&(p.current&&e.current.setFeatureState({source:d,id:p.current},{selected:!1}),e.current.setFeatureState({source:d,id:o.id},{selected:!0}),p.current=o.id)}),[o]),Object(n.useEffect)((function(){e.current&&e.current.loaded()&&(console.log("setting fill color to be ",l["fill-color"],l),e.current.setPaintProperty("".concat(t,"-fill"),"fill-color",l["fill-color"]))}),[l])}(B,"HTC",Object(s.a)({},I,{onClick:function(e){return p(e)},selection:m})),F(B,l)),D=L(B,g),P=function(e,t){return Object(n.useMemo)((function(){return e?t.features.filter((function(t){return t.properties.GEOID==e})).map((function(e){return e.properties})):[]}),[e,t])}(m?m.properties.GEOID:null,D);return r.a.createElement("div",{className:"main-page"},r.a.createElement("div",{className:"map",ref:e}),r.a.createElement("div",{className:"details"},r.a.createElement(S,{facilities:P,feature:m})," "),r.a.createElement(v,{boundaries:M,selectedBoundary:l,onSelectBoundary:c,showFacilities:g,onShowFacilitiesChange:C,metric:N,onSelectMetric:x}))}a(81);var B=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(i.a,{basename:"/NYCCensusCountMap"},r.a.createElement(o.a,{path:"/",component:x})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(B,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[52,1,2]]]);
//# sourceMappingURL=main.40ba38fc.chunk.js.map