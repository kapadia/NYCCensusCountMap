(this.webpackJsonpmap=this.webpackJsonpmap||[]).push([[0],{51:function(e,t,a){e.exports=a(84)},56:function(e,t,a){},81:function(e,t,a){},84:function(e,t,a){"use strict";a.r(t);var n=a(1),l=a.n(n),r=a(29),c=a.n(r),i=(a(56),a(46)),o=a(9),s=a(14),u=a(3),d=a(30),m=a.n(d);a(57);var p=a(16),f=a(17);function y(){return l.a.createElement("section",{className:"contact-type"},l.a.createElement("ul",null,l.a.createElement("li",{className:"category-entry"},l.a.createElement(p.a,{icon:f.a,style:{color:"#C2A5CF"}})," ","Internet First, English"),l.a.createElement("li",{className:"category-entry"},l.a.createElement(p.a,{icon:f.a,style:{color:"#9970AB"}})," ","Internet First, Bilingual"),l.a.createElement("li",{className:"category-entry"},l.a.createElement(p.a,{icon:f.a,style:{color:"#A6DBA0"}})," ","Internet Choice, English"),l.a.createElement("li",{className:"category-entry"},l.a.createElement(p.a,{icon:f.a,style:{color:"#5AAE61"}})," ","Internet Choice, Bilingual")))}var h=a(43),b=a.n(h);a(63);function g(e){var t=e.boundaries,a=e.selectedBoundary,n=e.onSelect;return l.a.createElement("section",{className:"boundary-selector"},l.a.createElement("h4",null,"Boundaries"),t&&l.a.createElement(b.a,{options:Object.entries(t).map((function(e){var t=Object(u.a)(e,2);return{value:t[0],label:t[1].datasetName}})),onChange:function(e){return n(e.value)},value:a,placeholder:"Select a boundary"}))}function E(e){var t=e.selectedBoundary,a=e.boundaries,n=e.onSelectBoundary;return l.a.createElement("div",{className:"Legend"},l.a.createElement("section",{className:"thematic-layer"},l.a.createElement(y,null),l.a.createElement(g,{selectedBoundary:t,onSelect:n,boundaries:a})))}var v=a(34);function C(e){var t=e.facility;return console.log("facilty",t),l.a.createElement("div",{className:"card facility"},l.a.createElement("h3",null,t.facname),l.a.createElement("p",null,t.address," ",l.a.createElement("br",null)," ",t.boro," ",l.a.createElement("br",null)," ",t.city," ",l.a.createElement("br",null)," ",t.zipcode),l.a.createElement("p",null,t.factype," "),l.a.createElement("p",null,"Capacity: ",t.capacity?t.capacity:"Unknown"))}function O(e){var t=e.feature,a=e.facilities;console.log(t);var r=Object(n.useState)(!1),c=Object(u.a)(r,2),i=c[0],o=c[1];return l.a.createElement("div",{className:"feature"},t?l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"details-header"},l.a.createElement("h2",null,"Census Tract: ",t.properties.GEOID),l.a.createElement("p",null,l.a.createElement("span",{onClick:function(){return o(!1)},className:i?"":"selected"},"Stats")," ","/"," ",l.a.createElement("span",{onClick:function(){return o(!0)},className:i?"selected":""},"Facilities"))),l.a.createElement("div",{className:"cards"},i?a.map((function(e){return l.a.createElement(C,{facility:e})})):l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"card basic"},l.a.createElement("h3",null,"Basic Info"),l.a.createElement("p",null,"Population ",t.properties.TotPopACS17),l.a.createElement("p",null,"Mail return rate 2010 :",t.properties.MRR2010,"%")),l.a.createElement("div",{className:"card demographics"},l.a.createElement("h3",null,"Demographics")),l.a.createElement("div",{className:"card english_proficency"},l.a.createElement("h3",null,"English Proficency"),l.a.createElement(v.a,{width:200,height:200,data:function(e){return["LEPHHs","LEPspanHHs","LEPindoeurHHs","LEPapacHHs","LEPotherHHs"].map((function(t){return{angle:e.properties[t],label:t}}))}(t),showLabels:!0,labelsRadiusMultiplier:1.1,labelsStyle:{fontSize:12},innerRadius:80,radius:100})),l.a.createElement("div",{className:"card internet"},l.a.createElement("h3",null,"Internet"),l.a.createElement(v.a,{width:200,height:200,data:function(e){return["NoInternet","Internet_NoSub","Internet","DialUpOnly","Broadband_Any","Cellular","CellularOnly","Broadband_CableFiberOpticDSL","Broadband_CableFiberOpticDSLOnly","Satellite","SatelliteOnly","OtherOnly"].map((function(t){return{angle:e.properties[t],label:t}}))}(t),showLabels:!0,labelsRadiusMultiplier:1.1,innerRadius:80,radius:100,labelsStyle:{fontSize:12}}))))):l.a.createElement("h2",null,"Click to see details of feature"))}var j=a(45),N=a.n(j);var S={geojsonLayer:{url:"".concat("/NYCCensusCountMap","/CensusTractsAllVariables.geojson"),paintFill:{"fill-color":["match",["get","strategy_code"],0,"#C2A5CF",1,"#9970AB",2,"#A6DBA0",3,"#5AAE61","grey"],"fill-opacity":.7},paintLine:{"line-color":"lightgrey"}},censusStrategyLayer:{url:"https://gis-server.data.census.gov/arcgis/rest/services/Hosted/Mail_Strategy_VectorTile/VectorTileServer/tile/{z}/{y}/{x}.pbf",sourceLayer:"Mail Strategy",paintFill:{"fill-color":["match",["get","_symbol"],0,"#C2A5CF",1,"#9970AB",2,"#A6DBA0",3,"#5AAE61","grey"]},paintLine:{"line-color":"lightgrey","line-width":.2}},HTCLayer:{url:"https://b.tiles.mapbox.com/v4/cunycur.9zkm964v/{z}/{x}/{y}.vector.pbf?access_token=pk.eyJ1IjoiY3VueWN1ciIsImEiOiJfQmNSMF9NIn0.uRgbcFeJbw2xyTUZY8gYeA",sourceLayer:"Tract2017wgs84_HTConly-c1gvdq",paintFill:{"fill-color":"red"},paintLine:{"line-color":"lightgrey","line-width":.2}}};function w(e,t){var a=Object(n.useState)({}),l=Object(u.a)(a,2),r=l[0],c=l[1];return Object(n.useEffect)((function(){if(e.current){var a={};e.current.on("load",(function(){console.log("adding boundary layers"),[{id:"cd",datasetName:"Community Districts",url:"http://data.cityofnewyork.us/api/geospatial/yfnk-k7r4?method=export&format=Shapefile",nameCol:"boro_cd",nameAlt:null},{id:"pp",datasetName:"Police Precincts",url:"http://data.cityofnewyork.us/api/geospatial/78dh-3ptz?method=export&format=Shapefile",nameCol:"precinct",nameAlt:null},{id:"sd",datasetName:"School Districts",url:"http://data.cityofnewyork.us/api/geospatial/r8nu-ymqj?method=export&format=Shapefile",nameCol:"district",nameAlt:"districtco"},{id:"hc",datasetName:"Health Center Districts",url:"http://data.cityofnewyork.us/api/geospatial/b55q-34ps?method=export&format=Shapefile",nameCol:"hcent_dist",nameAlt:null},{id:"cc",datasetName:"City Council Districts",url:"http://data.cityofnewyork.us/api/geospatial/yusd-j4xi?method=export&format=Shapefile",nameCol:"coun_dist",nameAlt:null},{id:"nycongress",datasetName:"Congressional Districts",url:"http://data.cityofnewyork.us/api/geospatial/qd3c-zuu7?method=export&format=Shapefile",nameCol:"cong_dist",nameAlt:null},{id:"sa",datasetName:"State Assembly Districts",url:"http://data.cityofnewyork.us/api/geospatial/pf5b-73bw?method=export&format=Shapefile",nameCol:"assem_dist",nameAlt:null},{id:"ss",datasetName:"State Senate Districts",url:"http://data.cityofnewyork.us/api/geospatial/h4i2-acfi?method=export&format=Shapefile",nameCol:"st_sen_dis",nameAlt:null},{id:"nta",datasetName:"Neighborhood Tabulation Area",url:"http://data.cityofnewyork.us/api/geospatial/cpf4-rkhq?method=export&format=Shapefile",nameCol:"ntaname",nameAlt:"ntacode"},{id:"bid",datasetName:"Business Improvement District",url:"http://data.cityofnewyork.us/api/geospatial/ejxk-d93y?method=export&format=Shapefile",nameCol:"bid",nameAlt:null}].map((function(e){return Object(s.a)({},e,{paintLine:{"line-color":"black"}})})).forEach((function(n){var l="".concat(n.id,"_source"),r=Object(s.a)({},n);console.log("adding source ",l),r.source=e.current.addSource(l,{type:"geojson",data:"".concat("/NYCCensusCountMap","/boundaries/").concat(n.id,".geojson")}),n.paintFill&&(r.fillLayer=e.current.addLayer({id:"".concat(n.id,"-fill"),type:"fill",source:l,paint:n.paintFill},"waterway-label")),n.paintLine&&(r.lineLayer=e.current.addLayer({id:"".concat(n.id,"-line"),type:"line",source:l,paint:n.paintLine,layout:{visibility:t==n.id?"visible":"none"}},"waterway-label")),a[n.id]=r})),c(a)}))}}),[e]),Object(n.useEffect)((function(){e.current&&Object.entries(r).forEach((function(a){var n=Object(u.a)(a,2),l=n[0],r=n[1];e.current.setLayoutProperty("".concat(r.id,"-line"),"visibility",l==t?"visible":"none")}))}),[e,t]),r}function A(e){var t=function(){var e=Object(n.useState)(null),t=Object(u.a)(e,2),a=t[0],l=t[1];return Object(n.useEffect)((function(){fetch("".concat("/NYCCensusCountMap","/facilities.geojson")).then((function(e){return e.json()})).then((function(e){return l(e)}))}),[]),a}();return Object(n.useEffect)((function(){console.log("Map ",e," Facilities ",t),e.current&&t&&e.current.on("load",(function(){e.current.addLayer({id:"facilites",type:"symbol",source:{type:"geojson",data:t},layout:{"icon-image":"harbor_icon","text-field":["get","facname"],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-offset":[0,.6],"text-anchor":"top"}})}))}),[e,t]),t}function k(){var e=Object(n.useRef)(null),t=Object(n.useState)("cd"),a=Object(u.a)(t,2),r=a[0],c=a[1],i=Object(n.useState)(null),o=Object(u.a)(i,2),d=o[0],p=o[1],f=Object(n.useState)([]),y=Object(u.a)(f,2),h=(y[0],y[1]);Object(n.useEffect)((function(){N.a.parse("/hard_to_count_NY.csv",{download:!0,header:!0,complete:function(e){h(e)}})}),[]);var b=function(e,t){var a=t.lnglat,l=t.zoom,r=t.style,c=t.key;m.a.accessToken=c;var i=Object(n.useRef)(null);return Object(n.useEffect)((function(){i.current=new m.a.Map({container:e.current,style:r,center:a,zoom:l})}),[e]),i}(e,{lnglat:[-73.9920330193022,40.75078660435196],zoom:10,style:"mapbox://styles/mapbox/light-v10",key:"pk.eyJ1Ijoic3R1YXJ0LWx5bm4iLCJhIjoiM2Q4ODllNmRkZDQ4Yzc3NTBhN2UyNDE0MWY2OTRiZWIifQ.8OEKvgZBCCtDFUXkjt66Pw"}),g=(function(e,t,a){var l=a.url,r=a.paintFill,c=a.paintLine,i=(a.sourceLayer,a.onClick),o=Object(n.useRef)(null),s=Object(n.useRef)(null),u=Object(n.useRef)(null),d="".concat(t,"_source");Object(n.useEffect)((function(){e.current&&e.current.on("load",(function(){u.current=e.current.addSource(d,{type:"geojson",data:l}),r&&(o.current=e.current.addLayer({id:"".concat(t,"-fill"),type:"fill",source:d,paint:r},"waterway-label")),c&&(s.current=e.current.addLayer({id:"".concat(t,"-line"),type:"line",source:d,paint:c},"waterway-label")),e.current.on("click","".concat(t,"-fill"),(function(e){console.log(e.features[0]),i&&i(e.features[0])}))}))}),[e])}(b,"HTC",Object(s.a)({},S.geojsonLayer,{onClick:function(e){return p(e)}})),w(b,r)),v=A(b);console.log("sf ",d),console.log("selected id ",d?d.properties.GEOID:null),console.log(v);var C=function(e,t){return Object(n.useMemo)((function(){return e?t.features.filter((function(t){return t.properties.GEOID==e})).map((function(e){return e.properties})):[]}),[e,t])}(d?d.properties.GEOID:null,v);return console.log("tract facilities ",C),l.a.createElement("div",{className:"main-page"},l.a.createElement("div",{className:"map",ref:e}),l.a.createElement("div",{className:"details"},l.a.createElement(O,{facilities:C,feature:d})," "),l.a.createElement(E,{boundaries:g,selectedBoundary:r,onSelectBoundary:c}))}a(81);var L=function(){return l.a.createElement("div",{className:"App"},l.a.createElement(i.a,{basename:"/NYCCensusCountMap"},l.a.createElement(o.a,{path:"/",component:k})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(l.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[51,1,2]]]);
//# sourceMappingURL=main.9cac45e9.chunk.js.map