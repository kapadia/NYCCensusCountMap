(this.webpackJsonpmap=this.webpackJsonpmap||[]).push([[0],{52:function(e,t,a){e.exports=a(84)},57:function(e,t,a){},81:function(e,t,a){},84:function(e,t,a){"use strict";a.r(t);var n=a(1),l=a.n(n),r=a(30),c=a.n(r),i=(a(57),a(47)),o=a(9),s=a(12),u=a(3),m=a(31),d=a.n(m);a(58);var p=a(16),f=a(17);function y(){return l.a.createElement("section",{className:"contact-type"},l.a.createElement("ul",null,l.a.createElement("li",{className:"category-entry"},l.a.createElement(p.a,{icon:f.a,style:{color:"#C2A5CF"}})," ","Internet First, English"),l.a.createElement("li",{className:"category-entry"},l.a.createElement(p.a,{icon:f.a,style:{color:"#9970AB"}})," ","Internet First, Bilingual"),l.a.createElement("li",{className:"category-entry"},l.a.createElement(p.a,{icon:f.a,style:{color:"#A6DBA0"}})," ","Internet Choice, English"),l.a.createElement("li",{className:"category-entry"},l.a.createElement(p.a,{icon:f.a,style:{color:"#5AAE61"}})," ","Internet Choice, Bilingual")))}function b(e){var t=e.name,a=e.min,n=e.max,r=e.colStart,c=e.colEnd,i="linear-gradient(90deg, ".concat(r," 0%, ").concat(c," 100%)");return console.log("gradient is ",i),l.a.createElement("div",{className:"range-legend"},l.a.createElement("h4",{className:"range-legend-title"},t),l.a.createElement("div",{className:"range-legend-bar",style:{background:i}}),l.a.createElement("div",{className:"range-legend-labels"},l.a.createElement("p",null,a)," ",l.a.createElement("p",null,n)))}var h=a(21),E=a.n(h);a(38);function g(e){var t=e.boundaries,a=e.selectedBoundary,n=e.onSelect;return l.a.createElement("section",{className:"boundary-selector"},l.a.createElement("h4",null,"Boundaries"),t&&l.a.createElement(E.a,{options:Object.entries(t).map((function(e){var t=Object(u.a)(e,2);return{value:t[0],label:t[1].datasetName}})),onChange:function(e){return n(e.value)},value:a,placeholder:"Select a boundary"}))}function C(e){var t=e.selectedBoundary,a=e.boundaries,n=e.onSelectBoundary,r=e.showFacilities,c=e.onShowFacilitiesChange,i=e.onSelectMetric,o=e.metric;return l.a.createElement("div",{className:"Legend"},l.a.createElement("section",{className:"thematic-layer"},l.a.createElement(E.a,{options:[{value:"strategy",label:"Mail Strategy"},{value:"returnCount",label:"2020 Mail Return Rate"}],onChange:function(e){return i(e.value)},value:o,placeholder:"Select a metric"}),"strategy"==o?l.a.createElement(y,null):l.a.createElement(b,{name:"2020 Mail Return %",min:0,max:100,colStart:"#309dae",colEnd:"#ebf7f9"}),l.a.createElement(g,{selectedBoundary:t,onSelect:n,boundaries:a}),l.a.createElement("div",{className:"facilitesToggle"},l.a.createElement("p",null,"Show Facilities"," ",l.a.createElement("input",{type:"checkbox",checked:r,onChange:function(e){return c(e.target.checked)}})))))}var v=a(35);function S(e){var t=e.facility;return console.log("facilty",t),l.a.createElement("div",{className:"card facility"},l.a.createElement("h3",null,t.facname),l.a.createElement("p",null,t.address," ",l.a.createElement("br",null)," ",t.boro," ",l.a.createElement("br",null)," ",t.city," ",l.a.createElement("br",null)," ",t.zipcode),l.a.createElement("p",null,t.factype," "),l.a.createElement("p",null,"Capacity: ",t.capacity?t.capacity:"Unknown"))}function O(e){var t=e.feature,a=e.facilities;e.onSelectFacility;console.log(t);var r=Object(n.useState)(!1),c=Object(u.a)(r,2),i=c[0],o=c[1];return l.a.createElement("div",{className:"feature"},t?l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"details-header"},l.a.createElement("h2",null,"Census Tract: ",t.properties.GEOID),l.a.createElement("p",null,l.a.createElement("span",{onClick:function(){return o(!1)},className:i?"":"selected"},"Stats")," ","/"," ",l.a.createElement("span",{onClick:function(){return o(!0)},className:i?"selected":""},"Facilities"))),l.a.createElement("div",{className:"cards"},i?a.map((function(e){return l.a.createElement(S,{facility:e})})):l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"card basic"},l.a.createElement("h3",null,"Basic Info"),l.a.createElement("p",null,"Population ",t.properties.TotPopACS17),l.a.createElement("p",null,"Mail return rate 2010 :",t.properties.MRR2010,"%")),l.a.createElement("div",{className:"card demographics"},l.a.createElement("h3",null,"Demographics"),l.a.createElement("p",null,"White :"," ",t.properties.WhiteAloneOrCombo/t.properties.TotPopACS17," ","%"),l.a.createElement("p",null,"Black:"," ",t.properties.BlackAloneOrCombo/t.properties.TotPopACS17," ","%"),l.a.createElement("p",null,"Asian:"," ",t.properties.AsianAloneOrCombo/t.properties.TotPopACS17," ","%"),l.a.createElement("p",null,"Hispanic:"," ",t.properties.Hispanic/t.properties.TotPopACS17," ","%")),l.a.createElement("div",{className:"card english_proficency"},l.a.createElement("h3",null,"English Proficency"),l.a.createElement(v.a,{width:200,height:200,data:function(e){return["LEPHHs","LEPspanHHs","LEPindoeurHHs","LEPapacHHs","LEPotherHHs"].map((function(t){return{angle:e.properties[t],label:t}}))}(t),showLabels:!0,labelsRadiusMultiplier:1.1,labelsStyle:{fontSize:12},innerRadius:80,radius:100})),l.a.createElement("div",{className:"card internet"},l.a.createElement("h3",null,"Internet"),l.a.createElement(v.a,{width:200,height:200,data:function(e){return["NoInternet","Internet_NoSub","Internet","DialUpOnly","Broadband_Any","Cellular","CellularOnly","Broadband_CableFiberOpticDSL","Broadband_CableFiberOpticDSLOnly","Satellite","SatelliteOnly","OtherOnly"].map((function(t){return{angle:e.properties[t],label:t}}))}(t),showLabels:!0,labelsRadiusMultiplier:1.1,labelsStyle:{fontSize:12,color:"white"}}))))):l.a.createElement("h2",null,"Click to see details of feature"))}var j=a(46),N=a.n(j);var w={strategy:["match",["get","strategy_code"],0,"#C2A5CF",1,"#9970AB",2,"#A6DBA0",3,"#5AAE61","grey"],returnCount:["interpolate",["linear"],["get","MRR2010"],0,"#309dae",100,"#ebf7f9"]},k={HTCLayer:{url:"".concat("/NYCCensusCountMap","/CensusTractsAllVariables.geojson"),paintFill:{"fill-color":"grey","fill-opacity":.7},paintLine:{"line-color":"white"}}};function A(e,t){var a=Object(n.useState)({}),l=Object(u.a)(a,2),r=l[0],c=l[1];return Object(n.useEffect)((function(){if(e.current){var a={};e.current.on("load",(function(){console.log("adding boundary layers"),[{id:"cd",datasetName:"Community Districts",url:"http://data.cityofnewyork.us/api/geospatial/yfnk-k7r4?method=export&format=Shapefile",nameCol:"boro_cd",nameAlt:null},{id:"pp",datasetName:"Police Precincts",url:"http://data.cityofnewyork.us/api/geospatial/78dh-3ptz?method=export&format=Shapefile",nameCol:"precinct",nameAlt:null},{id:"sd",datasetName:"School Districts",url:"http://data.cityofnewyork.us/api/geospatial/r8nu-ymqj?method=export&format=Shapefile",nameCol:"district",nameAlt:"districtco"},{id:"hc",datasetName:"Health Center Districts",url:"http://data.cityofnewyork.us/api/geospatial/b55q-34ps?method=export&format=Shapefile",nameCol:"hcent_dist",nameAlt:null},{id:"cc",datasetName:"City Council Districts",url:"http://data.cityofnewyork.us/api/geospatial/yusd-j4xi?method=export&format=Shapefile",nameCol:"coun_dist",nameAlt:null},{id:"nycongress",datasetName:"Congressional Districts",url:"http://data.cityofnewyork.us/api/geospatial/qd3c-zuu7?method=export&format=Shapefile",nameCol:"cong_dist",nameAlt:null},{id:"sa",datasetName:"State Assembly Districts",url:"http://data.cityofnewyork.us/api/geospatial/pf5b-73bw?method=export&format=Shapefile",nameCol:"assem_dist",nameAlt:null},{id:"ss",datasetName:"State Senate Districts",url:"http://data.cityofnewyork.us/api/geospatial/h4i2-acfi?method=export&format=Shapefile",nameCol:"st_sen_dis",nameAlt:null},{id:"nta",datasetName:"Neighborhood Tabulation Area",url:"http://data.cityofnewyork.us/api/geospatial/cpf4-rkhq?method=export&format=Shapefile",nameCol:"ntaname",nameAlt:"ntacode"},{id:"bid",datasetName:"Business Improvement District",url:"http://data.cityofnewyork.us/api/geospatial/ejxk-d93y?method=export&format=Shapefile",nameCol:"bid",nameAlt:null}].map((function(e){return Object(s.a)({},e,{paintLine:{"line-color":"black"}})})).forEach((function(n){var l="".concat(n.id,"_source"),r=Object(s.a)({},n);console.log("adding source ",l),r.source=e.current.addSource(l,{type:"geojson",data:"".concat("/NYCCensusCountMap","/boundaries/").concat(n.id,".geojson")}),n.paintFill&&(r.fillLayer=e.current.addLayer({id:"".concat(n.id,"-fill"),type:"fill",source:l,paint:n.paintFill},"waterway-label")),n.paintLine&&(r.lineLayer=e.current.addLayer({id:"".concat(n.id,"-line"),type:"line",source:l,paint:n.paintLine,layout:{visibility:t==n.id?"visible":"none"}},"waterway-label")),a[n.id]=r})),c(a)}))}}),[e]),Object(n.useEffect)((function(){e.current&&Object.entries(r).forEach((function(a){var n=Object(u.a)(a,2),l=n[0],r=n[1];e.current.setLayoutProperty("".concat(r.id,"-line"),"visibility",l==t?"visible":"none")}))}),[e,t]),r}function L(e,t){var a=function(){var e=Object(n.useState)(null),t=Object(u.a)(e,2),a=t[0],l=t[1];return Object(n.useEffect)((function(){fetch("".concat("/NYCCensusCountMap","/facilities.geojson")).then((function(e){return e.json()})).then((function(e){return l(e)}))}),[]),a}();return Object(n.useEffect)((function(){console.log("Map ",e," Facilities ",a),e.current&&a&&e.current.on("load",(function(){e.current.loadImage("".concat("/NYCCensusCountMap","/marker.png"),(function(n,l){if(n)throw n;e.current.addImage("marker",l),e.current.addLayer({id:"facilities",type:"symbol",source:{type:"geojson",data:a},layout:{"icon-image":"marker","icon-size":.4,"text-field":["get","facname"],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-offset":[0,.6],"text-size":10,"text-anchor":"top",visibility:t?"visible":"none"}})}))}))}),[e,a]),Object(n.useEffect)((function(){e.current&&e.current.isStyleLoaded()&&e.current.setLayoutProperty("facilities","visibility",t?"visible":"none")}),[e,t]),a}function B(){var e=Object(n.useRef)(null),t=Object(n.useState)("cd"),a=Object(u.a)(t,2),r=a[0],c=a[1],i=Object(n.useState)(null),o=Object(u.a)(i,2),m=o[0],p=o[1],f=Object(n.useState)([]),y=Object(u.a)(f,2),b=(y[0],y[1]),h=Object(n.useState)(!0),E=Object(u.a)(h,2),g=E[0],v=E[1],S=Object(n.useState)("strategy"),j=Object(u.a)(S,2),B=j[0],x=j[1];Object(n.useEffect)((function(){N.a.parse("/hard_to_count_NY.csv",{download:!0,header:!0,complete:function(e){b(e)}})}),[]);var F=function(e,t){var a=t.lnglat,l=t.zoom,r=t.style,c=t.key;d.a.accessToken=c;var i=Object(n.useRef)(null);return Object(n.useEffect)((function(){i.current=new d.a.Map({container:e.current,style:r,center:a,zoom:l})}),[e]),i}(e,{lnglat:[-73.9920330193022,40.75078660435196],zoom:10,style:"mapbox://styles/mapbox/light-v10",key:"pk.eyJ1Ijoic3R1YXJ0LWx5bm4iLCJhIjoiM2Q4ODllNmRkZDQ4Yzc3NTBhN2UyNDE0MWY2OTRiZWIifQ.8OEKvgZBCCtDFUXkjt66Pw"}),D=Object(s.a)({},k.HTCLayer,{},{paintFill:{"fill-color":w[B]}});console.log("style is ",D);!function(e,t,a){var l=a.url,r=a.paintFill,c=a.paintLine,i=(a.sourceLayer,a.onClick),o=Object(n.useRef)(null),s=Object(n.useRef)(null),u=Object(n.useRef)(null),m="".concat(t,"_source");Object(n.useEffect)((function(){e.current&&e.current.on("load",(function(){u.current=e.current.addSource(m,{type:"geojson",data:l}),r&&(o.current=e.current.addLayer({id:"".concat(t,"-fill"),type:"fill",source:m,paint:r},"waterway-label")),c&&(s.current=e.current.addLayer({id:"".concat(t,"-line"),type:"line",source:m,paint:c},"waterway-label")),e.current.on("click","".concat(t,"-fill"),(function(e){console.log(e.features[0]),i&&i(e.features[0])}))}))}),[e]),Object(n.useEffect)((function(){e.current&&e.current.isStyleLoaded()&&(console.log("setting fill color to be ",r["fill-color"],r),e.current.setPaintProperty("".concat(t,"-fill"),"fill-color",r["fill-color"]))}),[r])}(F,"HTC",Object(s.a)({},D,{onClick:function(e){return p(e)}}));var M=A(F,r),I=L(F,g),P=function(e,t){return Object(n.useMemo)((function(){return e?t.features.filter((function(t){return t.properties.GEOID==e})).map((function(e){return e.properties})):[]}),[e,t])}(m?m.properties.GEOID:null,I);return l.a.createElement("div",{className:"main-page"},l.a.createElement("div",{className:"map",ref:e}),l.a.createElement("div",{className:"details"},l.a.createElement(O,{facilities:P,feature:m})," "),l.a.createElement(C,{boundaries:M,selectedBoundary:r,onSelectBoundary:c,showFacilities:g,onShowFacilitiesChange:v,metric:B,onSelectMetric:x}))}a(81);var x=function(){return l.a.createElement("div",{className:"App"},l.a.createElement(i.a,{basename:"/NYCCensusCountMap"},l.a.createElement(o.a,{path:"/",component:B})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(l.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[52,1,2]]]);
//# sourceMappingURL=main.fe6b62e4.chunk.js.map